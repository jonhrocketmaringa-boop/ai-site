<script>
const chatBox = document.getElementById("chat");

function addMessage(text, type) {
  const div = document.createElement("div");
  div.className = "msg " + type;
  div.innerText = text;
  chatBox.appendChild(div);
  div.scrollIntoView();
}

async function askAI() {
  const input = document.getElementById("msg");
  const text = input.value.trim();
  if (!text) return;

  addMessage(text, "user");
  input.value = "";

  const loading = document.createElement("div");
  loading.className = "msg bot";
  loading.innerText = "جاري التفكير...";
  chatBox.appendChild(loading);

  try {
    const res = await fetch(
      "https://api.affiliateplus.xyz/api/chatbot?message=" +
      encodeURIComponent(text)
    );
    const data = await res.json();

    loading.innerText = data.message || "ماكو رد حالياً";

  } catch {
    loading.innerText = "تعذر الاتصال بالذكاء الاصطناعي";
  }
}
</script>
